# Vim

三种模式：

- 指令模式/普通模式：快捷键
- 输入模式/编辑模式：输入文本
- 行末模式/命令模式：界面底部，输入Vim命令行

其中指令模式的按键命令都可以在行末模式中使用，所以有时也看做是两种模式

- 命令模式
- 输入模式

```bash
# 编辑文件
# 文件不存在时，会编辑一个空白文件，但需要手动保存才会写入到磁盘文件
vim <文件>
# 编辑一个空白文件
# 保存时需要提供文件名
vim
```

## **命令模式**

以下约定：

- 按键之间用`+`连接表示同时按下，如Shift+g
- 按键之间用`,`连接表示先后按下，如d,d
- 数字用`n`表示，在按键上直接依次按该数字的数码，如1,2,3
- 按键上的字符均是指小写模式下，输入该字符需要的按键，如G表示Shift+g

### **切换模式**

i：进入输入模式的插入功能，从光标所在位置开始插入

a：进入输入模式的添加插入功能，从光标所在的下一个位置开始插入

/：进入行末模式的查找功能

:：进入行末模式的命令行功能

### **定位**

Home：光标移动到行首

End：光标移动到行尾

Page Up：上翻一页

Page Down：下翻一页

n,G（即Shift+g）：跳转到第n行

g,g：跳转到第一行

G,G：跳转到最后一行

w：跳到下一个单词（适合逐词阅读英文文本）

b：跳到上一个单词

### **编辑**

### **历史记录**

Z,Z：保存并退出

u：撤销上次操作

Ctrl+r：重做上次撤销的操作

.：重复上次操作

### **删除**

dd：删除当前行

d,n,d：删除从当前行起往下的n行（含当前行，共n行）

d,n,↓：删除当前行和下边的n行（含当前行，共n+1行）

d,n,↑：删除当前行和上边的n行（含当前行，共n+1行）

d,n,→：删除从当前字符起往右的n个字符（含当前字符，共n个字符），不会跨行

d,n,←：删除当前字符左边的n个字符（不含当前字符，共n个字符），不会跨行

J：删除当前行行尾的换行符，将下一行接在当前行的后面

x：删除当前一个字符

### **复制**

yy：复制当前行

y,n,y：复制从当前行起往下的n行（含当前行，共n行）

y,n,↓：复制当前行和下边的n行（含当前行，共n+1行）

y,n,↑：复制当前行和上边的n行（含当前行，共n+1行）

y,n,→：复制从当前字符起往右的n个字符（含当前字符，共n个字符），不会跨行

y,n,←：复制当前字符左边的n个字符（不含当前字符，共n个字符），不会跨行

p：粘贴。对于行内容，粘贴在当前行的下面；对于行内字符内容，粘贴在当前字符的后面

### **替换**

r,任意字符：将光标所在的字符替换成其他字符

### **查找**

n：跳转到设定的查找方向上的下一个匹配位置

N：跳转到设定的查找方向上的上一个匹配位置（反向一个）

*：跳转到光标的后面一个匹配位置（与查找方向无关）

\#：跳转到光标的前面一个匹配位置（与查找方向无关）

## **行末模式**

### **查找**

从光标处向下查找

```
/<模式串>
```

从光标处向上查找

```
?<模式串>
```

`<模式串>`：可以使用正则表达式

### **行末命令行**

一些命令可以组合，比如`wq`

### **文件**

保存

```
# 保存文件，写入内容
w
# 以指定的文件名保存文件
w <文件名>
```

新建

```
# 新建空白文件
new
# 以指定的文件名新建文件（未写入）
new <文件名>
```

### **界面**

退出

```
# 退出Vim
q
# 强制退出（不保存）
q!
```

### **替换**

```
<查找范围> s/<查找模式串>/<替换内容>/<标记>
```

查找范围：

- 空：当前行
- `%`：全文查找
- `m,n`：从第m行到第n行
- `m,$`：从第m行到最后一行（没有第一行的写法）

标记：

- 空：查找范围内的每行只替换第一处
- `g`：查找范围中的每一处都替换

### **过滤**

```
# 选中符合模式的行，并对其执行操作
g/<模式串>/<操作命令>
# 选中不符合模式的行，并对其进行操作
v/<模式串>/<操作命令>
```

操作命令可以使用`d`、`y`等命令

## **使用模式**

在分隔窗格的情况下，一般将最左边全高的窗格作为写代码的窗格，右边的做调试或其他之用。

vim开启行号的情况下，默认行号占3个宽度，加1个空格，共4个宽度。在80处设置提示线。因此，写代码的窗格宽度应该为4 + 80 = 84。注意，每行代码不要超过79个宽度。
